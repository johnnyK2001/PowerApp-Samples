function getAccountDetails(executionContext) {
  let formContext = executionContext.getFormContext();
  let nameValue = formContext.getAttribute("firstname");
  let email = formContext.getAttribute("emailaddress1");
  let accNum = formContext.getAttribute("mobilephone");

  // Getting Guid of record of parent table
 

  let lookupValue = formContext.getAttribute("parentcustomerid").getValue();
  

  if (lookupValue !==null) {
    let accountId = Xrm.Page.getAttribute("parentcustomerid").getValue()[0].id.replace("{", "")
    .replace("}", "").toLowerCase();

    // Use Dataverse Rest Builder
    Xrm.WebApi.retrieveRecord(
      "account",
      accountId,
      // these are the fields of parent table from where we are getting values
      "?$select=name,accountnumber,emailaddress1 " 
    ).then(function success(result) {
      var accountid = result["accountid"]; // Guid
      var name = result["name"]; // Text
      var accountnumber = result["accountnumber"]; // Text
      var emailaddress1 = result["emailaddress1"];

      nameValue.setValue(name);
      email.setValue(emailaddress1);
      accNum.setValue(accountnumber);
    });
  } else {
    nameValue.setValue();
    email.setValue();
    accNum.setValue();
  }
}
